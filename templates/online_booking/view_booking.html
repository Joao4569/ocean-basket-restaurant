{% extends "online_booking/base.html" %}

{% load account %}

{% block content %}

{% load crispy_forms_tags %}

{% if user.is_authenticated and user.is_staff %}

  <div class="booking_table table-responsive mx-auto">
    <table class="table table-sm table-bordered table-hover">
      <thead class="thead-dark">
        <tr>
          <th class="text-center" scope="col">Booking Title</th>
          <th class="text-center" scope="col">Date</th>
          <th class="text-center" scope="col">Service</th>
          <th class="text-center" scope="col">Seats</th>
        </tr>
      </thead>
      <tbody>
      {% for booking in bookings %}
        <tr>
          <td class="text-center">{{ booking.booking_title }}</td>
          <td class="text-center">{{ booking.date }}</td>
          <td class="text-center">{{ booking.service }}</td>
          <td class="text-center">{{ booking.number_of_seats }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div> 

<h2>Lunch:</h2>

<div class="col-12 py-3">
  <a href="{% url 'account_logout' %}">
    <button type="button" class="button-font btn btn-outline-dark font-elsie font-weight-bold">Logout</button>
  </a>
</div>

{% elif user.is_authenticated %}

  <div class="container text-center responsive-width">
    <h2 class="heading mt-5 mb-3 font-elsie pb-3">Your Bookings:</h2>
  </div>

  <div class="booking_table table-responsive mx-auto">
    <table class="table table-sm table-bordered table-hover">
      <thead class="thead-dark">
        <tr>
          <th class="text-center" scope="col">Booking Title</th>
          <th class="text-center" scope="col">Date</th>
          <th class="text-center" scope="col">Service</th>
          <th class="text-center" scope="col">Seats</th>
          <th class="text-center" scope="col">Contact</th>
          <th class="text-center" scope="col" colspan="2">Options:</th>
        </tr>
      </thead>
      <tbody>
      {% for booking in bookings %}
        {% if booking.username == user.username %}
          <tr>
            <td class="text-center">{{ booking.booking_title }}</td>
            <td class="text-center">{{ booking.date }}</td>
            <td class="text-center">{{ booking.service }}</td>
            <td class="text-center">{{ booking.number_of_seats }}</td>
            <td class="text-center">{{ booking.contact_number }}</td>
            <td class="text-center">
              <a href="/edit_booking/{{ booking.id }}">
                <button class="btn-sm btn-outline-success font-weight-bold">Change</button>
              </a>
            </td>
            <td class="text-center">
              <a href="/delete_booking/{{ booking.id }}">
                <button class="btn-sm btn-outline-danger font-weight-bold">Delete</button>
              </a>
            </td>
          </tr>
        {% endif %}
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="container w-50 my-5">
    <div class="row text-center">
      <div class="col-12 col-lg-6 py-3">
        <a href="/create_booking">
          <button type="button" class="button-font btn btn-outline-dark font-elsie font-weight-bold">Make a booking</button>
        </a>
      </div>
      <div class="col-12 col-lg-6 py-3">
        <a href="{% url 'account_logout' %}">
          <button type="button" class="button-font btn btn-outline-dark font-elsie font-weight-bold">Logout</button>
        </a>
      </div>
    </div>
  </div>

{% else %}

  <div class="container text-center responsive-width">
    <h2 class="heading mt-5 mb-3">You are not logged in</h2>
    <p class="main-paragraph-text text-center mx-auto pt-2 pb-5">
      Please login or Sign up to view the contents of this page.
    </p>
  </div>

  <div class="container w-50 my-5">
    <div class="row text-center">
      <div class="col-12 col-md-6 py-3">
        <a href="{% url 'account_signup' %}">
          <button type="button" class="button-font btn btn-outline-dark font-elsie font-weight-bold">Sign Up</button>
        </a>
      </div>
      <div class="col-12 col-md-6 py-3">
        <a href="{% url 'account_login' %}">
          <button type="button" class="button-font btn btn-outline-dark font-elsie font-weight-bold">Login</button>
        </a>
      </div>
    </div>
  </div>

{% endif %}

{% endblock %}